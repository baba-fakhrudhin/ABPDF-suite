{% extends "base.html" %}
{% block content %}

<div class="text-center mb-10">
    <h1 class="text-4xl font-extrabold mb-4 bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent">
        Word to PDF
    </h1>
    <p class="text-gray-500 text-lg">
        Convert your Word document (.docx) into a PDF file.
    </p>
</div>

<div class="bg-white p-10 rounded-3xl shadow-2xl max-w-2xl mx-auto border border-gray-100">

    <form id="wordToPdfForm" class="space-y-6">

        <div>
            <label class="block font-semibold mb-2">Upload Word File</label>
            <input 
                type="file" 
                name="file" 
                accept=".docx"
                required 
                class="w-full border p-4 rounded-xl focus:ring-2 focus:ring-blue-500 transition"
            >
        </div>

        <button type="submit"
            class="w-full py-4 rounded-2xl text-white font-bold text-lg 
                   bg-gradient-to-r from-blue-600 to-indigo-600 
                   hover:scale-105 hover:shadow-xl transition duration-300">
            Convert to PDF
        </button>
    </form>

    <div id="loader" class="hidden mt-8 text-center">
        <div class="animate-spin h-14 w-14 border-4 border-blue-600 border-t-transparent rounded-full mx-auto"></div>
        <p class="mt-4 text-gray-600 font-medium">Converting your file...</p>
    </div>

</div>

<script>
    alert('Respected Judges this conversion will fail on sample pdf because the module docx2pdf i used to convert requires windows Word to be installed but the hosting site or deployment site which i am using to deploy doesnt support it... \n I can make it work fine but it requires purchasing a plan !.. it works fine in my system ... ');
document.getElementById("wordToPdfForm").addEventListener("submit", async function(e) {
    e.preventDefault();

    const loader = document.getElementById("loader");
    loader.classList.remove("hidden");

    const formData = new FormData(this);

    try {
        const response = await fetch("/word-to-pdf", {
            method: "POST",
            body: formData,
            credentials: "include"
        });

        loader.classList.add("hidden");

        if (!response.ok) {
            const err = await response.json();
            alert(err.error || "Conversion failed");
            return;
        }

        const blob = await response.blob();
        const url = window.URL.createObjectURL(blob);

        const a = document.createElement("a");
        a.href = url;
        a.download = "converted.pdf";
        document.body.appendChild(a);
        a.click();
        a.remove();

    } catch (error) {
        loader.classList.add("hidden");
        alert("Server error. Please try again.");
    }
});
</script>

{% endblock %}
